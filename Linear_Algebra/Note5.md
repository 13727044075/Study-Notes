# Note5

标签（空格分隔）： 线性代数

---
继续是线性代数的学习笔记，这次的笔记包含第七、八节课的内容。



### 求解Ax=0

第七节课是[求解Ax=0：主变量、特解][1]

  首先是介绍求解$Ax=0$的算法，**核心方法还是使用消元。**消元是不会改变方程的解，同时通过消元可以知道哪些行是无关的，无关的行会在消元后变为0，以及哪些列会是主列和自由列，这里主列是指主元所在的列。

> **主元是指将一个矩阵A通过初等变换（包括初等行变换和列变换）化为规范阶梯型矩阵B后，矩阵B中每行从左往右，第一个非零的元素必定是1，这个1就是主元。**

> 所谓**规范阶梯型**就是这样的一个矩阵：

> * 矩阵中的每行从左往右，第一个非零元素必定是1，1前面的元素都是零；
> * 第i+1行中的第一个非零元素（也就是1）的位置要在第i行中的1的后面；
> * 主元1上方的元素都是零。

> 满足上面三个规律的矩阵叫做规范阶梯型。

例子：有一个矩阵$A=\begin{bmatrix}1 & 2 & 2 & 2 \\ 2 & 4 & 6 & 8 \\ 3 & 6 & 8 & 10 \end{bmatrix}$,首先可以看到第三行是前两行的线性组合，而第二列也是第一列的线性组合。

下面开始进行消元：
$$
A-->(r2=r2-2r1,r3=r3-3r1)\begin{bmatrix}1 & 2 & 2 & 2 \\ 0 & 0 & 2 & 4 \\ 0 & 0 & 2 & 4 \end{bmatrix} -->(r3=r2-r3)\begin{bmatrix}1 & 2 & 2 & 2 \\ 0 & 0 & 2 & 4 \\ 0 & 0 & 0 & 0 \end{bmatrix}
$$

令$U=\begin{bmatrix}1 & 2 & 2 & 2 \\ 0 & 0 & 2 & 4 \\ 0 & 0 & 0 & 0 \end{bmatrix}$,则有$Ax=Ux=0$。

可以看到矩阵$U$的主元有2个，分别是$U_{11},U_{23}$，那么主列就是第一和第三列，第二，第四列就是自由列，对应的向量$x$中的变量$x_2,x_4$就是自由变量了，也就是它们可以自由分配自己的值，简单说就是在接下来**回代**一步中，我们可以自己设置这两个变量的值，**自由变量也称为特解。**

另外，矩阵的秩$r$等于其主元的数量，本例中矩阵$A$的秩$r=2$。

> 对于一个$m\times n$的矩阵A，$n$维列向量x，有A的秩是r，则自由变量为**$n-r$**个。

最后，可以将矩阵$U$继续简化成**简化行阶梯形式**，用$R$表示，**它是指令主元上下皆为0，且主元等于1。**

所以对于上例中的$U$,有：
$$
U-->(r1=r1-r2)\begin{bmatrix}1 & 2 & 0 & -2 \\ 0 & 0 & 2 & 4 \\ 0 & 0 & 0 & 0 \end{bmatrix} -->(r2=r2/2)\begin{bmatrix}1 & 2 & 0 & -2 \\ 0 & 0 & 1 & 2 \\ 0 & 0 & 0 & 0 \end{bmatrix}=R
$$

令矩阵$F$表示自由变量组成的矩阵，则有$R=\begin{bmatrix}I & F \\ 0 & 0\end{bmatrix}$,这里单位矩阵$I$是r列，矩阵$F$则是n-r列。

再构建一个**零空间矩阵**，其各列由特解组成，表示为$N=\begin{bmatrix}-F\\ I\end{bmatrix}$，因为$Rx=0-->\begin{bmatrix}I & F\end{bmatrix}\begin{bmatrix}x_{privot}\\ x_{free}\end{bmatrix}=0$,从而得到$RN=0$。

这里$x_{privot}和x_{free}$分别表示$x$中主元变量和自由变量。



### 求解Ax=b：可解性和解的结构

第八节课内容是[求解Ax=b：可解性和解的结构](http://open.163.com/movie/2010/11/V/8/M6V0BQC4M_M6V2ABHV8.html)。

首先还是沿用上一节课的例子：有一个矩阵$A=\begin{bmatrix}1 & 2 & 2 & 2 \\ 2 & 4 & 6 & 8 \\ 3 & 6 & 8 & 10 \end{bmatrix}$,此时右侧是一个向量$b = \begin{bmatrix}b_1 \\ b_2 \\ b_3 \end{bmatrix}$,根据上节课可以知道矩阵$A$的第三行是前两行相加的和，所以向量$b$应该满足$b_3 = b_1+b_2$。

这里要求解$Ax=b$，首先还是需要通过**消元**的方法，使用**增广矩阵(Augmented Matrix)**，即$[A | b]$,求解过程如下所示：
$$
A =
\left[
\begin{array}{cccc | c}
1 & 2 & 2 & 2 & b_1 \\
2 & 4 & 6 & 8 & b_2\\ 
3 & 6 & 8 & 10& b_3 
\end{array}
\right]
-->
\left[
\begin{array}{cccc | c}
1 & 2 & 2 & 2 & b_1 \\
0 & 0 & 2 & 4 & b_2-2b_1\\ 
0 & 0 & 2 & 4 & b_3-3b1 
\end{array}
\right]
-->
\left[
\begin{array}{cccc | c}
1 & 2 & 2 & 2 & b_1 \\
0 & 0 & 2 & 4 & b_2-2b_1\\ 
0 & 0 & 0 & 0 & b_3-b_2-b_1 
\end{array}
\right]
$$

这里可以同样得到有$0=b_3 - b_2 - b_1$，也就是$b_3 = b_1+b_2$。

##### 有解性

这里对于$Ax=b$的有解性是指当$Ax=b$有解时，向量$b$必须满足的条件，这个条件就是向量$b$必须是在矩阵$A$的列空间内，也就是矩阵$A$各列的一个线性组合。

##### 求Ax=b所有解

在上述消元后，就可以开始求解。$Ax=b$的解$x = x_p+x_n$,这里$x_p$表示特解，而$x_n$是指零空间的任意解，即满足$Ax=0$的解。

对于特解的求解方法是设自由变量为0，然后求出主元变量，得到的就是特解。

比如对于上述例子，可以假设$b = \begin{bmatrix}1 \\ 5 \\ 6 \end{bmatrix}$,然后自由变量设为0，也就是令$x_2=x_4=0$,然后回代会原方程组，可以得到一个特解$x_p=\begin{bmatrix} -2 \\ 0 \\ 3/2 \\ 0 \end{bmatrix}$。

然后对于$x_n$,就是求取零空间的解，这里同样可以得到如$\begin{bmatrix} -2 \\ 1 \\ 0\\ 0 \end{bmatrix},\begin{bmatrix} 2 \\ 0 \\ -2 \\ 1 \end{bmatrix}$。

所以上述例子的所有解可以表示为$x=\begin{bmatrix} -2 \\ 0 \\ 3/2 \\ 0 \end{bmatrix}+c_1 \begin{bmatrix} -2 \\ 1 \\ 0\\ 0 \end{bmatrix} + c_2 \begin{bmatrix} 2 \\ 0 \\ -2 \\ 1 \end{bmatrix}$

##### 更多

接下来考虑更一般的情况，对于一个$m\times n$且秩是$r$的矩阵$A$,秩也就是矩阵中主元的数量，因此其满足$r\le m,r\le n$。有下列几种情况：

###### (1) 列满秩

这种情况就是$r=n \lt m$的情况，此时没有自由变量，因此零空间只有一个零向量，**对于$Ax=b$，只有零个或1个解，且当其有1个解的时候，这个解是特解$x_p$。**

例子如$A = \begin{bmatrix} 1 & 3 \\ 2&1 \\ 6&1 \\ 5 &1 \end{bmatrix}​$,通过消元可以得到其行最简形式的矩阵为$R= \begin{bmatrix} 1 & 0 \\ 0&1 \\ 0&0 \\ 0&0 \end{bmatrix}​$，这是一个形如$\begin{bmatrix} I \\ F \end{bmatrix}​$的情况，其中$I​$是值单位矩阵，而$F​$是自由变量组成的矩阵。这个例子的唯一解是$x_p=\begin{bmatrix}1 \ 1 \end{bmatrix}​$。

###### (2) 行满秩

这种情况是$r=m \lt n$的情况，此时每行都有一个主元，其行最简形是没有零行的，也就是对于$Ax=b$，必然有解，而且是无穷多个解。

这里的例子可以将上述的例子进行转置$A=\begin{bmatrix} 1 & 2 & 6 & 5 \\ 3 & 1 & 1 & 1 \end{bmatrix}$,通过消元，最终得到如同$R = \begin{bmatrix} I & F \end{bmatrix}$的形式。

###### (3) r=m=n

这种情况算是综合上述两种情况的结果，零空间只有一个零向量，对于$Ax=b$，必然有解，且是唯一一个解。

例子有$A=\begin{bmatrix}1 & 2 \\ 3 & 1 \end{bmatrix}$,消元可以得到$R = \begin{bmatrix} I \end{bmatrix}$。

###### (4) 不满秩的情况

这是一般的情况，即$r<m,r<n$，此时有$R = \begin{bmatrix} I & F \\ 0 & 0 \end{bmatrix}$，对于$Ax=b$，有0个或无穷多个解。








[1]: http://open.163.com/movie/2010/11/H/H/M6V0BQC4M_M6V2ABAHH.html