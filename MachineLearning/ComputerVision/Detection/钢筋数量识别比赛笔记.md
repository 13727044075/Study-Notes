
比赛：https://www.datafountain.cn/competitions/332/details/data-evaluation


---
### 比赛简介



---
### To Do List

- [ ] 先跑通 yolov3 baseline 代码，提交一次结果
- [ ] 考虑数据处理，思考如数据裁剪问题，以及其他数据数理方式
- [ ] 调试 yolov3 anchor 文件，调试模型
- [ ] 尝试其他检测模型，考虑的会有如 darknet，mask r-cnn, faster r-cnn等
- [ ] 阅读目标检测相关论文和文章
- [ ] 模型融合

---

#### 1-16

又有几个开源代码了，其中一个线上 0.97--https://github.com/spytensor/detect_steel_bar

用的是 pytorch 版本的`retinanet`。



#### 01-15

没时间来看代码了。

看群里的说法，`max_box`应该设置为 273。

然后代码是分两个阶段训练的，第一阶段分别设置`epoch`为25个和15，第二阶段是60个epoch。这是群里一个分数达到 0.9777 的大佬分享的经验。

然后考虑从训练集选择部分图片作为验证集，计算`map`。

#### 01-14

- fpn，yolo v3都有跑到0.98或以上的分数

##### 记录

看群里有人解答了昨天的错误问题，应该是label文件里面，对应列`Detection`名字前多了一个空格。

晚上回家后，验证了这个解法是对的，顺利跑通代码`step_1_process_data.py`，生成文件夹`train_xml`，里面是以每张图片为名字的 xml 文件，xml 文件保存了图片的信息和对应的标签数据。

接着跑第二个代码`step_2_mv_data.py`，主要是移动训练数据和测试数据到指定的一个文件夹内，方便模型调用，并且将图片名字写入 txt 文件中。跑通了！

第三个代码`step_3_voc_annotation.py`，自动构建训练目录。也是跑通了。

第四个代码`step_4_train.py`，训练模型。暂时打算先在自己笔记本上跑，然后先安装了`keras`，接着提升没有`AttributeError: module 'tensorflow.python.ops.nn' has no attribute 'leaky_relu'`，估计是`tensorflow`版本问题，目前是`1.2`版本，因为是装了`cuda8`还是`cuda7`，尝试升级到`1.4`的版本看看，如果跑不通，尝试不用 gpu 版本，或者就只能用服务器了。

#### 01-12

报名，并加入QQ群，然后下载数据集。

群里分享了一份基础的 YOLOV3代码，得分大概是0.2左右，观察排行榜，最高是有0.9到1左右的得分。

看了下数据集，训练集250张图片，标注信息很多，因为是很多钢材在一张图片，另外，图片大小非常大，大概是`2666*2000`大小，这对于网络的学习很有挑战性。

根据群友的说法，图片不能过小，否则目标检测对于小目标密集问题无法解决。


#### 01-13

做一个简单的计划列表。

根据Q群群友提示：

- yolo v3 baseline中`get_random_data()`必须修改`random`参数，否则会压缩到只有 20 个检测框。
- 如果要提高精度，采用 fpn
- 融合模型做法，结果层做`nms`，`proposal`层做平均
- 一个想法，分割图片检测，再合并，来解决图片尺寸太大问题
- yolo_eval 里的参数`max_box`需要修改
- yolo v3 baseline 的源代码github：https://github.com/qqwweee/keras-yolo3

##### 记录

第一次跑 baseline 的代码`step_1_process_data.py`--将`train_labels.csv`和训练数据转换成`train.xml`文件，但是开始就报错：

```
KeyError: 'Detection'
```

但我看标注文件，分别有三列--`ID`、`Detection`、`AB`，其中第三个`AB`是空的。


